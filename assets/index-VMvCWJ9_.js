(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function t(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function s(r){if(r.ep)return;r.ep=!0;const i=t(r);fetch(r.href,i)}})();class y{root;currentPath;homeDirectory;constructor(e="/home/user"){this.homeDirectory=e,this.currentPath="~",this.root=this.createInitialStructure(),this.loadFromStorage()}createInitialStructure(){const e=new Date,t={name:"",type:"directory",children:new Map,permissions:"rwxr-xr-x",created:e,modified:e,size:0},s=this.createNode("home","directory"),r=this.createNode("user","directory"),i=this.createNode("Documents","directory"),o=this.createNode("Downloads","directory"),a=this.createNode("Pictures","directory"),n=this.createNode("Videos","directory"),c=this.createNode("readme.txt","file",`Welcome to H-Terminal!
This is a virtual file system.`),u=this.createNode("script.sh","file",`#!/bin/bash
echo "Hello World!"`);return r.children.set("Documents",i),r.children.set("Downloads",o),r.children.set("Pictures",a),r.children.set("Videos",n),r.children.set("readme.txt",c),r.children.set("script.sh",u),s.children.set("user",r),t.children.set("home",s),t}createNode(e,t,s){const r=new Date;return{name:e,type:t,content:s||"",children:t==="directory"?new Map:void 0,permissions:t==="directory"?"rwxr-xr-x":"rw-r--r--",created:r,modified:r,size:s?s.length:0}}getCurrentDirectory(){return this.currentPath}setCurrentDirectory(e){const t=this.resolvePath(e),s=this.getNodeByPath(t);return!s||s.type!=="directory"?!1:(this.currentPath=this.normalizeDisplayPath(t),this.saveToStorage(),!0)}listDirectory(e){const t=e?this.resolvePath(e):this.getAbsolutePath(this.currentPath),s=this.getNodeByPath(t);return!s||s.type!=="directory"||!s.children?[]:Array.from(s.children.values()).sort((r,i)=>r.type!==i.type?r.type==="directory"?-1:1:r.name.localeCompare(i.name))}createFile(e,t=""){if(this.exists(e))return!1;const s=this.getCurrentDirectoryNode();if(!s||!s.children)return!1;const r=this.createNode(e,"file",t);return s.children.set(e,r),s.modified=new Date,this.saveToStorage(),!0}createDirectory(e){if(this.exists(e))return!1;const t=this.getCurrentDirectoryNode();if(!t||!t.children)return!1;const s=this.createNode(e,"directory");return t.children.set(e,s),t.modified=new Date,this.saveToStorage(),!0}deleteNode(e,t=!1){const s=this.getCurrentDirectoryNode();if(!s||!s.children)return!1;const r=s.children.get(e);return!r||r.type==="directory"&&r.children&&r.children.size>0&&!t?!1:(s.children.delete(e),s.modified=new Date,this.saveToStorage(),!0)}readFile(e){const t=this.getNode(e);return!t||t.type!=="file"?null:t.content||""}writeFile(e,t){const s=this.getNode(e);return s&&s.type==="file"?(s.content=t,s.size=t.length,s.modified=new Date,this.saveToStorage(),!0):this.createFile(e,t)}exists(e){return this.getNode(e)!==null}getNode(e){if(e.includes("/"))return this.getNodeByPath(this.resolvePath(e));{const t=this.getCurrentDirectoryNode();return!t||!t.children?null:t.children.get(e)||null}}resolvePath(e){if(e==="~")return this.homeDirectory;if(e.startsWith("~/"))return this.homeDirectory+e.slice(1);if(e.startsWith("/"))return e;const t=this.getAbsolutePath(this.currentPath);if(e===".")return t;if(e===".."){const s=t.split("/").filter(r=>r);return s.pop(),"/"+s.join("/")}if(e.startsWith("../")){const s=t.split("/").filter(i=>i),r=e.split("/");for(const i of r)i===".."?s.pop():i!=="."&&s.push(i);return"/"+s.join("/")}return t+(t.endsWith("/")?"":"/")+e}getAbsolutePath(e){return e==="~"?this.homeDirectory:e.startsWith("~/")?this.homeDirectory+e.slice(1):e.startsWith("/")?e:this.homeDirectory+"/"+e}getCurrentDirectoryNode(){return this.getNodeByPath(this.getAbsolutePath(this.currentPath))}getNodeByPath(e){if(e==="/")return this.root;const t=e.split("/").filter(r=>r);let s=this.root;for(const r of t){if(!s.children||!s.children.has(r))return null;s=s.children.get(r)}return s}normalizeDisplayPath(e){return e===this.homeDirectory?"~":e.startsWith(this.homeDirectory+"/")?"~"+e.slice(this.homeDirectory.length):e}saveToStorage(){try{const e={root:this.serializeNode(this.root),currentPath:this.currentPath,homeDirectory:this.homeDirectory};localStorage.setItem("h-terminal-filesystem",JSON.stringify(e))}catch(e){console.warn("Failed to save filesystem to localStorage:",e)}}loadFromStorage(){try{const e=localStorage.getItem("h-terminal-filesystem");if(e){const t=JSON.parse(e);this.root=this.deserializeNode(t.root),this.currentPath=t.currentPath||"~"}}catch(e){console.warn("Failed to load filesystem from localStorage:",e)}}serializeNode(e){const t={name:e.name,type:e.type,content:e.content,permissions:e.permissions,created:e.created.toISOString(),modified:e.modified.toISOString(),size:e.size};return e.children&&(t.children=Array.from(e.children.entries()).map(([s,r])=>[s,this.serializeNode(r)])),t}deserializeNode(e){const t={name:e.name,type:e.type,content:e.content,permissions:e.permissions,created:new Date(e.created),modified:new Date(e.modified),size:e.size};if(e.children){t.children=new Map;for(const[s,r]of e.children)t.children.set(s,this.deserializeNode(r))}return t}}class w{outputElement;inputElement;promptElement;config;constructor(e,t,s,r){this.outputElement=e,this.inputElement=t,this.promptElement=s,this.config=r,this.updatePrompt()}addOutput(e,t="output-line"){e.split(`
`).forEach(r=>{const i=document.createElement("div");i.className=t,i.textContent=r,this.outputElement.appendChild(i)}),this.scrollToBottom()}clearOutput(){this.outputElement.innerHTML=""}updatePrompt(){this.promptElement.textContent=this.config.prompt}focus(){this.inputElement.focus()}getInputValue(){return this.inputElement.value}setInputValue(e){this.inputElement.value=e}clearInput(){this.inputElement.value=""}updateConfig(e){this.config={...this.config,...e},this.updatePrompt()}scrollToBottom(){this.outputElement.scrollTop=this.outputElement.scrollHeight}}class C{history=[];currentIndex=-1;maxSize;constructor(e=1e3){this.maxSize=e,this.loadFromStorage()}add(e){e.trim()!==""&&this.history[this.history.length-1]!==e&&(this.history.push(e),this.history.length>this.maxSize&&this.history.shift(),this.currentIndex=this.history.length,this.saveToStorage())}get(e){return this.history[e]}getAll(){return[...this.history]}getPrevious(){if(this.currentIndex>0)return this.currentIndex--,this.history[this.currentIndex]}getNext(){return this.currentIndex<this.history.length-1?(this.currentIndex++,this.history[this.currentIndex]):(this.currentIndex=this.history.length,"")}clear(){this.history=[],this.currentIndex=-1,this.saveToStorage()}size(){return this.history.length}resetIndex(){this.currentIndex=this.history.length}saveToStorage(){try{localStorage.setItem("h-terminal-history",JSON.stringify(this.history))}catch(e){console.warn("Failed to save history to localStorage:",e)}}loadFromStorage(){try{const e=localStorage.getItem("h-terminal-history");e&&(this.history=JSON.parse(e),this.currentIndex=this.history.length)}catch(e){console.warn("Failed to load history from localStorage:",e)}}}class D{io;history;onCommandExecute;onTabComplete;constructor(e,t,s,r=()=>[]){this.io=e,this.history=t,this.onCommandExecute=s,this.onTabComplete=r,this.setupEventListeners()}setupEventListeners(){this.io.inputElement.addEventListener("keydown",t=>{this.handleKeyDown(t)}),document.addEventListener("click",()=>{this.io.focus()})}handleKeyDown(e){switch(e.key){case"Enter":this.handleEnter();break;case"ArrowUp":e.preventDefault(),this.handleArrowUp();break;case"ArrowDown":e.preventDefault(),this.handleArrowDown();break;case"Tab":e.preventDefault(),this.handleTab();break;case"c":e.ctrlKey&&(e.preventDefault(),this.handleCtrlC());break;case"l":e.ctrlKey&&(e.preventDefault(),this.io.clearOutput());break}}handleEnter(){const e=this.io.getInputValue();this.history.add(e),this.history.resetIndex(),this.onCommandExecute(e),this.io.clearInput()}handleArrowUp(){const e=this.history.getPrevious();e!==void 0&&this.io.setInputValue(e)}handleArrowDown(){const e=this.history.getNext();e!==void 0&&this.io.setInputValue(e)}handleTab(){const e=this.io.getInputValue(),t=this.onTabComplete(e);t.length===1?this.io.setInputValue(t[0]):t.length>1&&(this.io.addOutput("Available options:","output-line"),this.io.addOutput(t.join("  "),"output-line"))}handleCtrlC(){this.io.addOutput("^C","output-line"),this.io.clearInput()}}class v{commands=new Map;aliases=new Map;registerCommand(e){this.commands.set(e.name.toLowerCase(),e),e.aliases&&e.aliases.forEach(t=>{this.aliases.set(t.toLowerCase(),e.name.toLowerCase())})}unregisterCommand(e){const t=this.commands.get(e.toLowerCase());t&&(t.aliases&&t.aliases.forEach(s=>{this.aliases.delete(s.toLowerCase())}),this.commands.delete(e.toLowerCase()))}async executeCommand(e,t){if(!e.trim())return{success:!0,exitCode:0};const{command:s,args:r,flags:i}=this.parseInput(e),o=this.aliases.get(s.toLowerCase())||s.toLowerCase(),a=this.commands.get(o);if(!a)return{success:!1,error:`bash: ${s}: command not found`,exitCode:127};try{const n={...t,args:r,flags:i};return await Promise.resolve(a.execute(n))}catch(n){return{success:!1,error:n instanceof Error?n.message:"Unknown error occurred",exitCode:1}}}getCommand(e){const t=this.aliases.get(e.toLowerCase())||e.toLowerCase();return this.commands.get(t)}getAllCommands(){return Array.from(this.commands.values()).sort((e,t)=>e.name.localeCompare(t.name))}parseInput(e){const t=this.tokenize(e);if(t.length===0)return{command:"",args:[],flags:new Map};const s=t[0],r=[],i=new Map;for(let o=1;o<t.length;o++){const a=t[o];if(a.startsWith("--")){const n=a.indexOf("=");if(n>0){const c=a.substring(2,n),u=a.substring(n+1);i.set(c,u)}else{const c=a.substring(2);o+1<t.length&&!t[o+1].startsWith("-")?(i.set(c,t[o+1]),o++):i.set(c,!0)}}else if(a.startsWith("-")&&a.length>1){const n=a.substring(1);for(let c=0;c<n.length;c++){const u=n[c];c===n.length-1&&o+1<t.length&&!t[o+1].startsWith("-")?(i.set(u,t[o+1]),o++):i.set(u,!0)}}else r.push(a)}return{command:s,args:r,flags:i}}getCompletions(e){const{command:t,args:s}=this.parseInput(e);if(s.length===0&&!e.endsWith(" ")){const r=Array.from(this.commands.keys()).filter(i=>i.startsWith(t.toLowerCase())).concat(Array.from(this.aliases.keys()).filter(i=>i.startsWith(t.toLowerCase())));return[...new Set(r)].sort()}else{const r=this.aliases.get(t.toLowerCase())||t.toLowerCase(),i=this.commands.get(r);return i&&"getCompletions"in i?i.getCompletions(s):[]}}tokenize(e){const t=[];let s="",r=!1,i="",o=!1;for(let a=0;a<e.length;a++){const n=e[a];if(o){s+=n,o=!1;continue}if(n==="\\"){o=!0;continue}if(!r&&(n==='"'||n==="'")){r=!0,i=n;continue}if(r&&n===i){r=!1,i="";continue}if(!r&&n===" "){s&&(t.push(s),s="");continue}s+=n}return s&&t.push(s),t}}class h{aliases;success(e){return{success:!0,output:e||[],exitCode:0}}error(e,t=1){return{success:!1,error:e,exitCode:t}}validateArgs(e,t,s){return e.length<t?this.error(`${this.name}: missing arguments
Usage: ${this.usage}`):s!==void 0&&e.length>s?this.error(`${this.name}: too many arguments
Usage: ${this.usage}`):null}hasFlag(e,t){return e.has(t)&&e.get(t)===!0}getFlagValue(e,t){const s=e.get(t);return typeof s=="string"?s:null}}class x extends h{name="help";description="Show available commands and their descriptions";usage="help [command]";aliases=["?"];execute(e){const{args:t}=e;if(t.length===0){const s=["Available commands:",""];return[{name:"help",description:"Show this help message"},{name:"clear",description:"Clear the terminal screen"},{name:"pwd",description:"Print working directory"},{name:"ls",description:"List directory contents"},{name:"cd",description:"Change directory"},{name:"mkdir",description:"Create directory"},{name:"touch",description:"Create empty file"},{name:"cat",description:"Display file contents"},{name:"rm",description:"Remove files or directories"},{name:"cp",description:"Copy files or directories"},{name:"mv",description:"Move/rename files or directories"},{name:"echo",description:"Display text"},{name:"whoami",description:"Display current user"},{name:"hostname",description:"Display system hostname"},{name:"date",description:"Display current date and time"},{name:"history",description:"Show command history"}].forEach(i=>{s.push(`  ${i.name.padEnd(12)} - ${i.description}`)}),s.push(""),s.push('Type "help <command>" for detailed information about a specific command.'),this.success(s)}else{const s=t[0];return this.success([`Help for "${s}" command would be shown here`])}}}class S extends h{name="clear";description="Clear the terminal screen";usage="clear";aliases=["cls"];execute(e){return e.terminal.clearOutput(),this.success()}}class N extends h{name="echo";description="Display a line of text";usage="echo [text...]";execute(e){const{args:t}=e,s=t.join(" ");return this.success([s])}}class E extends h{name="whoami";description="Display the current username";usage="whoami";execute(e){const t=e.environment.get("USER")||"user";return this.success([t])}}class I extends h{name="hostname";description="Display the system hostname";usage="hostname";execute(e){const t=e.environment.get("HOSTNAME")||"localhost";return this.success([t])}}class P extends h{name="date";description="Display the current date and time";usage="date";execute(){const e=new Date;return this.success([e.toString()])}}class O extends h{name="history";description="Display command history";usage="history";execute(){const e=["Command history:","(History access would be implemented through dependency injection)"];return this.success(e)}}class b extends h{name="pwd";description="Print name of current/working directory";usage="pwd";execute(e){const t=e.fileSystem.getCurrentDirectory(),s=e.fileSystem.getAbsolutePath(t);return this.success([s])}}class T extends h{name="ls";description="List directory contents";usage="ls [options] [directory]";aliases=["dir"];execute(e){const{args:t,flags:s}=e,r=this.hasFlag(s,"a")||this.hasFlag(s,"all"),i=this.hasFlag(s,"l")||this.hasFlag(s,"long"),o=t[0]||"",a=e.fileSystem.listDirectory(o);if(a.length===0)return this.success([]);const n=[];return a.forEach(c=>{if(!(!r&&c.name.startsWith(".")))if(i){const u=c.permissions,d=c.size.toString().padStart(8),f=c.modified.toLocaleDateString(),p=c.type==="directory"?"d":"-",g=c.type==="directory"?`${c.name}/`:c.name;n.push(`${p}${u} ${d} ${f} ${g}`)}else{const u=c.type==="directory"?`${c.name}/`:c.name;n.push(u)}}),i?this.success(n):this.success([n.join("  ")])}}class L extends h{name="cd";description="Change the current directory";usage="cd [directory]";execute(e){const{args:t}=e,s=t[0]||"~";return e.fileSystem.setCurrentDirectory(s)?this.success():this.error(`cd: ${s}: No such file or directory`)}}class A extends h{name="mkdir";description="Create directories";usage="mkdir [options] directory...";execute(e){const{args:t}=e,s=this.validateArgs(t,1);if(s)return s;const r=[];for(const i of t)e.fileSystem.createDirectory(i)||r.push(`mkdir: cannot create directory '${i}': File exists or invalid name`);return r.length>0?this.error(r.join(`
`)):this.success()}}class F extends h{name="touch";description="Create empty files or update file timestamps";usage="touch file...";execute(e){const{args:t}=e,s=this.validateArgs(t,1);if(s)return s;const r=[];for(const i of t)if(e.fileSystem.exists(i)){const o=e.fileSystem.getNode(i);o&&(o.modified=new Date)}else e.fileSystem.createFile(i)||r.push(`touch: cannot touch '${i}': Invalid file name`);return r.length>0?this.error(r.join(`
`)):this.success()}}class z extends h{name="cat";description="Display file contents";usage="cat file...";execute(e){const{args:t}=e,s=this.validateArgs(t,1);if(s)return s;const r=[];for(const i of t){const o=e.fileSystem.readFile(i);if(o===null)return this.error(`cat: ${i}: No such file or directory`);o&&r.push(...o.split(`
`))}return this.success(r)}}class $ extends h{name="rm";description="Remove files and directories";usage="rm [options] file...";execute(e){const{args:t,flags:s}=e,r=this.validateArgs(t,1);if(r)return r;const i=this.hasFlag(s,"r")||this.hasFlag(s,"R")||this.hasFlag(s,"recursive"),o=this.hasFlag(s,"f")||this.hasFlag(s,"force"),a=[];for(const n of t){if(!e.fileSystem.exists(n)&&!o){a.push(`rm: cannot remove '${n}': No such file or directory`);continue}!e.fileSystem.deleteNode(n,i)&&!o&&a.push(`rm: cannot remove '${n}': Directory not empty (use -r to remove directories)`)}return a.length>0?this.error(a.join(`
`)):this.success()}}class k{fileSystem;terminalIO;history;commandProcessor;config;environment;constructor(){const e=document.getElementById("terminal-output"),t=document.getElementById("terminal-input"),s=document.getElementById("prompt");if(!e||!t||!s)throw new Error("Required terminal DOM elements not found");this.config={user:"user",hostname:"localhost",homeDirectory:"/home/user",prompt:"user@localhost:~$ ",theme:"dark",maxHistorySize:1e3},this.environment=new Map([["USER",this.config.user],["HOSTNAME",this.config.hostname],["HOME",this.config.homeDirectory],["PWD",this.config.homeDirectory],["SHELL","/bin/bash"],["TERM","xterm-256color"]]),this.fileSystem=new y(this.config.homeDirectory),this.history=new C(this.config.maxHistorySize),this.terminalIO=new w(e,t,s,this.config),this.commandProcessor=new v,this.registerCommands(),new D(this.terminalIO,this.history,r=>this.executeCommand(r),r=>this.getCompletions(r)),this.showWelcome()}registerCommands(){[new x,new S,new N,new E,new I,new P,new O,new b,new T,new L,new A,new F,new z,new $].forEach(t=>{this.commandProcessor.registerCommand(t)})}async executeCommand(e){if(!e.trim())return;this.updatePrompt();const t=this.config.prompt;this.terminalIO.addOutput(`${t}${e}`,"command-line");try{const s={terminal:this.terminalIO,fileSystem:this.fileSystem,environment:this.environment,workingDirectory:this.fileSystem.getCurrentDirectory()},r=await this.commandProcessor.executeCommand(e,s);r.output&&r.output.length>0&&r.output.forEach(i=>{this.terminalIO.addOutput(i,"output-line")}),!r.success&&r.error&&this.terminalIO.addOutput(r.error,"error-line")}catch(s){this.terminalIO.addOutput(`Error: ${s instanceof Error?s.message:"Unknown error"}`,"error-line")}this.updateEnvironment(),this.updatePrompt()}getCompletions(e){return this.commandProcessor.getCompletions(e)}updatePrompt(){const e=this.fileSystem.getCurrentDirectory();this.config.prompt=`${this.config.user}@${this.config.hostname}:${e}$ `,this.terminalIO.updateConfig({prompt:this.config.prompt})}updateEnvironment(){const e=this.fileSystem.getCurrentDirectory(),t=this.fileSystem.getAbsolutePath(e);this.environment.set("PWD",t)}showWelcome(){this.terminalIO.addOutput("Welcome to H-Terminal","success-line"),this.terminalIO.addOutput("A modern web-based terminal emulator","success-line"),this.terminalIO.addOutput('Type "help" to see available commands',"success-line"),this.terminalIO.addOutput("","output-line"),this.updatePrompt(),this.terminalIO.focus()}start(){this.terminalIO.focus()}}function m(){try{new k().start()}catch(l){console.error("Failed to initialize terminal:",l)}}document.readyState==="loading"?document.addEventListener("DOMContentLoaded",m):m();
